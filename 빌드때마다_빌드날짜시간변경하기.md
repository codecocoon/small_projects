<요구사항>
빌드 시마다, 빌드 빌드 날짜와 시간을 바꿔서 빌들을 해야 함.
CMake에서 되야 하며, 빌드 때마다 갱신이 되어야 한다.
windows와 linux 둘다 되어야 한다.


네, 말씀하신 방법은 Windows와 Linux 모두에서 동작하도록 구성할 수 있습니다. 다만, 각 운영체제에서 현재 날짜와 시간을 가져오는 명령어가 다르기 때문에, CMake 스크립트에서 이를 고려하여 플랫폼에 따라 적절한 명령어를 사용하도록 설정해야 합니다.

아래에 Windows와 Linux 모두에서 빌드 시마다 빌드 날짜와 시간을 갱신하는 방법을 자세히 설명하겠습니다.

1. 플랫폼별로 현재 날짜와 시간 가져오기

CMake에서는 CMAKE_SYSTEM_NAME 변수를 사용하여 현재 시스템의 이름을 알 수 있습니다. 이를 활용하여 Windows와 Linux에서 각각 다른 명령어를 사용할 수 있습니다.

---
(1) CMakeLists.txt 수정
---
``` cmake
cmake_minimum_required(VERSION 3.0)
project(MyProject)

# 소스 파일 설정
set(SOURCES
  serverinfo.cpp
  # 다른 소스 파일들
)

# build_time.h 파일 생성하는 커스텀 커맨드 생성
add_custom_command(
  OUTPUT "${CMAKE_BINARY_DIR}/build_time.h"
  COMMAND ${CMAKE_COMMAND} -P "${CMAKE_SOURCE_DIR}/update_build_time.cmake"
  DEPENDS "${CMAKE_SOURCE_DIR}/update_build_time.cmake"
  COMMENT "빌드 시간 정보를 생성 중..."
)

# build_time 타겟 생성 (항상 빌드되도록 설정)
add_custom_target(build_time ALL DEPENDS "${CMAKE_BINARY_DIR}/build_time.h")

# 실행 파일 생성 및 컴파일러 옵션 설정
add_executable(MyExecutable ${SOURCES})
target_include_directories(MyExecutable PRIVATE "${CMAKE_BINARY_DIR}")

# 의존성 설정
add_dependencies(MyExecutable build_time)
```

---
(2) update_build_time.cmake 스크립트 작성
프로젝트 소스 디렉토리에 update_build_time.cmake 파일을 생성합니다.
---
``` cmake
# 현재 시스템 이름 가져오기
if(NOT DEFINED CMAKE_SYSTEM_NAME)
  set(CMAKE_SYSTEM_NAME "${CMAKE_HOST_SYSTEM_NAME}")
endif()

# 운영체제별로 날짜와 시간 가져오는 명령어 설정
if("${CMAKE_SYSTEM_NAME}" STREQUAL "Windows")
  # Windows 명령어 (PowerShell 사용)
  execute_process(COMMAND powershell -Command "Get-Date -Format yyyy-MM-dd"
                  OUTPUT_VARIABLE BUILD_DATE
                  OUTPUT_STRIP_TRAILING_WHITESPACE)
  execute_process(COMMAND powershell -Command "Get-Date -Format HH:mm:ss"
                  OUTPUT_VARIABLE BUILD_TIME
                  OUTPUT_STRIP_TRAILING_WHITESPACE)
else()
  # Linux/Unix 명령어
  execute_process(COMMAND date "+%Y-%m-%d"
                  OUTPUT_VARIABLE BUILD_DATE
                  OUTPUT_STRIP_TRAILING_WHITESPACE)
  execute_process(COMMAND date "+%H:%M:%S"
                  OUTPUT_VARIABLE BUILD_TIME
                  OUTPUT_STRIP_TRAILING_WHITESPACE)
endif()

# build_time.h 파일 생성
file(WRITE "${CMAKE_BINARY_DIR}/build_time.h" "#define BUILD_DATE \"${BUILD_DATE}\"\n")
file(APPEND "${CMAKE_BINARY_DIR}/build_time.h" "#define BUILD_TIME \"${BUILD_TIME}\"\n")
```

---
(3) serverinfo.cpp에서 헤더 파일 포함하기
---
``` cmake
#include "build_time.h"
#include <iostream>

int main() {
    std::cout << "빌드 날짜: " << BUILD_DATE << std::endl;
    std::cout << "빌드 시간: " << BUILD_TIME << std::endl;
    return 0;
}
```
---

설명

	•	CMAKE_SYSTEM_NAME 사용: 현재 빌드하고 있는 시스템의 운영체제 이름을 가져옵니다. Windows의 경우 “Windows”로, Linux의 경우 “Linux” 등으로 설정됩니다.
	•	execute_process(): 운영체제별로 다른 명령어를 사용하여 현재 날짜와 시간을 가져옵니다.
	•	Windows:
	•	PowerShell 명령어 Get-Date -Format yyyy-MM-dd와 Get-Date -Format HH:mm:ss를 사용하여 날짜와 시간을 가져옵니다.
	•	Linux/Unix:
	•	date "+%Y-%m-%d"와 date "+%H:%M:%S" 명령어를 사용합니다.
	•	build_time.h 파일 생성: 가져온 날짜와 시간을 사용하여 build_time.h 파일을 생성하고, 매크로로 정의합니다.
	•	CMakeLists.txt에서의 설정:
	•	add_custom_command()와 add_custom_target()을 사용하여 build_time.h 파일이 빌드 시마다 생성되도록 합니다.
	•	target_include_directories()를 사용하여 build_time.h 파일이 있는 디렉토리를 인클루드 패스로 추가합니다.
	•	add_dependencies()를 통해 실행 파일이 build_time 타겟에 의존하도록 설정하여, 빌드 시에 build_time.h가 먼저 생성되도록 합니다.

3. 주의 사항

	•	PowerShell 사용: Windows에서 날짜와 시간을 가져오기 위해 PowerShell을 사용합니다. 이 경우 시스템에 PowerShell이 설치되어 있어야 합니다. 일반적으로 최신 Windows 버전에는 기본적으로 포함되어 있습니다.
	•	윈도우 커맨드 프롬프트(cmd.exe) 대안: 만약 PowerShell 사용이 불가능한 경우, cmd.exe의 명령어를 사용할 수 있습니다. 하지만 date와 time 명령어는 사용자 입력을 요구할 수 있으므로, 사용에 주의해야 합니다.
	•	플랫폼 확인: CMake의 CMAKE_SYSTEM_NAME 변수는 크로스 컴파일 환경에서는 타겟 시스템의 이름을 나타냅니다. 만약 호스트 시스템의 이름을 사용하려면 CMAKE_HOST_SYSTEM_NAME 변수를 사용할 수 있습니다.


